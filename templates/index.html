<!doctype html>
<html lang="es">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>Videoportero</title>
        <link
            rel="stylesheet"
            href="{{ url_for('static', filename='css/pages/index.css') }}"
        />
        <script
            src="https://kit.fontawesome.com/85c88a4976.js"
            crossorigin="anonymous"
        ></script>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h2>üö™ Video Portero Inteligente</h2>
            </div>

            <!-- Video + header -->
            <div class="card video-card">
                <div class="video-inner" id="videoInner">
                    <img id="stream" src="{{ url_for('video_feed') }}" />
                    <canvas
                        id="canvas"
                        width="640"
                        height="480"
                        style="display: none"
                    ></canvas>
                </div>

                <div class="status">
                    <div id="nfc-status" class="small">Status</div>
                </div>

                <!-- Accordion Principal -->
                <div class="main-accordion">
                    <div
                        class="accordion-header"
                        onclick="toggleMainAccordion()"
                    >
                        <div class="accordion-title">
                            <i
                                class="fa fa-user-times"
                                style="margin-right: 10px"
                                aria-hidden="true"
                            ></i>
                            Tarjetas desconocidas
                        </div>
                        <div class="accordion-icon" id="mainAccordionIcon">
                            ‚ñº
                        </div>
                    </div>
                    <div class="accordion-content" id="mainAccordionContent">
                        <!-- Controles para agregar elementos -->
                        <div class="counter" id="elementCounter">
                            Total desconocidas:
                            <span id="elementCount">0</span>
                        </div>

                        <!-- Tabla de elementos -->
                        <div class="table-container">
                            <table class="elements-table">
                                <thead>
                                    <tr>
                                        <th width="150">ID</th>
                                        <th>Nombre</th>
                                        <th width="180">Fecha</th>
                                    </tr>
                                </thead>
                                <tbody id="elementsTableBody">
                                    <tr>
                                        <td colspan="4">
                                            <div
                                                class="empty-state"
                                                id="emptyState"
                                            >
                                                üìù No hay elementos en la
                                                tabla.<br />
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Control panel -->
            <aside class="controls card">
                <div class="btn-grid" style="margin-top: 6px">
                    <button
                        class="btn primary"
                        id="openBtn"
                        title="Abrir port√≥n/puerta"
                        onclick="abrirPuerta()"
                    >
                        üîì Abrir
                    </button>
                    <button
                        class="btn warn"
                        id="unlockBtn"
                        title="Desbloquear remoto"
                    >
                        üîë Desbloquear
                    </button>
                    <button
                        class="btn"
                        id="snapshotBtn"
                        title="Tomar foto"
                        onclick="capturar()"
                    >
                        üì∏ Captura
                    </button>
                    <button
                        class="btn"
                        id="talkBtn"
                        title="Hablar (push to talk)"
                    >
                        üéôÔ∏è Hablar
                    </button>
                    <button class="btn" id="adminBtn" title="Usuarios">
                        üë® Usuarios
                    </button>
                    <button
                        id="reloadBtn"
                        class="btn"
                        style="padding: 8px 10px; font-size: 0.9rem"
                    >
                        <i class="fa fa-user-circle-o" aria-hidden="true"></i>
                        Usuarios
                    </button>
                </div>
            </aside>
        </div>
        <audio id="dooropen" preload="auto">
            <source
                src="{{ url_for('static', filename='sounds/open.mp3') }}"
                type="audio/mpeg"
            />
        </audio>

        <audio id="doorbell" preload="auto">
            <source
                src="{{ url_for('static', filename='sounds/doorbell.mp3') }}"
                type="audio/mpeg"
            />
        </audio>

        <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
        <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
        <script src="{{ url_for('static', filename='js/pages/index/scripts.js') }}"></script>
        <script src="{{ url_for('static', filename='js/pages/index/sockets.js') }}"></script>
    </body>
</html>
